{
  ;; C  | left_command  ;; Q  | right_command
  ;; T  | left_control  ;; W  | right_control
  ;; O  | left_option   ;; E  | right_option
  ;; S  | left_shift    ;; R  | right_shift
  ;; F  | fn            ;; !! | command + control + optional + shift (hyper)
  ;; !  | mandatory     ;; #  | optional (single)  ;; ## | optional any

  :profiles       {
                    :Default  {
                                :default true
                                :sim     50
                                :delay   500
                                :alone   1000
                                :held    500
                              }
                  }

  :input-sources  {
                    :en {:input_source_id "^com.apple.keylayout.US$"}
                    :ru {:input_source_id "^com.apple.keylayout.Russian$"}
                    :cs {:input_source_id "^com.apple.keylayout.Czech$"}
                  }

  :devices        {
                    :apple    [{:vendor_id 1452, :product_id 635}]
                    :keychron [{:vendor_id 1452, :product_id 591}]
                  }

  :templates      {
                    :open       "open \"%s\""
                    :open-app   "open -a \"%s\""
                    :choice-app "if [ $(hostname) = 'CIS-PRG10036.local' ] ; then  open -a \"%s\" ; else open -a \"%s\" ; fi"
                  }

  :layers         {
                    :launch-mode    {:key :tab}
                  }

  :main [
          {:des "Change input source to English by left_command; Russian by right_command."
           :rules [
                    [:left_command    :left_command    nil {:alone {:input :en}}]
                    [:right_command   :right_command   nil {:alone {:input :ru}}]
                    [:left_shift      :left_shift      nil {:alone {:input :en}}]
                    [:right_shift     :right_shift     nil {:alone {:input :ru}}]
                    [:!Cright_command :!Cright_command nil {:alone {:input :cs}}]
                    [:!Qleft_command  :!Qleft_command  nil {:alone {:input :cs}}]
                    [:!Sright_shift   :!Sright_shift   nil {:alone {:input :cs}}]
                    [:!Rleft_shift    :!Rleft_shift    nil {:alone {:input :cs}}]
                  ]
          }

          {:des "Section sign (ยง) to Escape and fn + Section sign (ยง) to Section sign (ยง)."
           :rules [:apple
                    [:non_us_backslash   :grave_accent_and_tilde]
                    [:!Cnon_us_backslash :!Cgrave_accent_and_tilde]
                    [:!Tnon_us_backslash :!Tgrave_accent_and_tilde]
                    [:!Fnon_us_backslash :non_us_backslash]
                  ]
          }

          {:des "Rules for Keychron keyboard"
           :rules [:keychron
                    [:right_control :right_option]
                  ]
          }

          {:des "Caps Lock to Hyper, alone to Escape"
           :rules [
                    [:caps_lock   :!CTOleft_shift nil {:alone :escape}]
                    [:!Ccaps_lock :!Cescape]
                    [:!Qcaps_lock :!Qescape]
                  ]
          }

          {:des "Map hyper+hjkl to arrows"
           :rules [
                    [:!!d :delete_forward]
                    [:!!h :left_arrow]
                    [:!!j :down_arrow]
                    [:!!k :up_arrow]
                    [:!!l :right_arrow]
                  ]
          }

          {:des "Snippets"
           :rules [
                    [:!Fopen_bracket   [:g :e :o :r :g :e :period :g :o :l :m :a :n :!S2 :g :m :a :i :l :period :c :o :m]]
                    [:!Fclose_bracket  [:g :r :i :g :o :r :i :i :period :g :o :l :m :a :n :!S2 :v :e :e :a :m :period :c :o :m]]
                  ]
          }

          {:des "Run applications"
           :rules [
                    [:!Creturn_or_enter [:open-app "iTerm"]]
                    [:!Qreturn_or_enter [:open-app "iTerm"]]
                  ]
          }

          {:des "Function keys"
           :rules [:launch-mode
                    [:##1          :f1]
                    [:##2          :f2]
                    [:##3          :f3]
                    [:##4          :f4]
                    [:##5          :f5]
                    [:##6          :f6]
                    [:##7          :f7]
                    [:##8          :f8]
                    [:##9          :f9]
                    [:##0          :f10]
                    [:##hyphen     :f11]
                    [:##equal_sign :f12]
                  ]
          }

          {:des "Run applications in launch mode"
           :rules [:launch-mode
                    [:return_or_enter [:open-app   "Terminal"]]
                    [:1               [:open-app   "1Password 7"]]
                    [:w               [:choice-app "Brave Browser" "Safari"]]
                    [:e               [:open-app   "Telegram"]]
                    [:r               [:open-app   "iTerm"]]
                    [:t               [:open-app   "Finder"]]
                    [:a               [:choice-app "Postman" "Paw"]]
                    [:s               [:choice-app "Sublime Text" "Visual Studio Code"]]
                    [:d               [:open-app   "IntelliJ IDEA"]]
                    [:f               [:open-app   "Fork"]]
                    [:g               [:open-app   "Garmin Express"]]
                    [:m               [:open-app   "Mail"]]
                    [:o               [:open-app   "Microsoft Teams"]]
                    [:p               [:choice-app "Adobe Photoshop 2022" "Pixelmator Pro"]]
                    [:z               [:open-app   "zoom.us"]]
                    [:x               [:open-app   "Spotify"]]
                    [:c               [:open-app   "Calendar"]]
                    [:b               [:choice-app "Safari" "Brave Browser"]]
                    [:close_bracket   [:open-app   "Cisco AnyConnect Secure Mobility Client"]]
                  ]
          }
        ]
}
